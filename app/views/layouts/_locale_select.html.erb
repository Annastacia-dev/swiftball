<select id="language-select" class="block w-full bg-gray-50 dark:bg-black rounded shadow-sm sm:text-sm text-xs">
  <option value="<%= url_for(locale: :en) %>" <%= 'selected' if I18n.locale == :en %>>English</option>
  <option value="<%= url_for(locale: :fr) %>" <%= 'selected' if I18n.locale == :fr %>>Français</option>
  <option value="<%= url_for(locale: :es) %>" <%= 'selected' if I18n.locale == :es %>>Español</option>
  <option value="<%= url_for(locale: :it) %>" <%= 'selected' if I18n.locale == :it %>>Italiano</option>
</select>

<script>
  function setLocale(){
    const selectElement = document.getElementById('language-select');
    const storedLocale = localStorage.getItem('locale');

    if (storedLocale) {
      selectElement.value = storedLocale;
    }

    selectElement.addEventListener('change', function() {
      localStorage.setItem('locale', this.value);
      window.location.href = this.value;
    });
  }
  document.addEventListener('DOMContentLoaded', setLocale);
  document.addEventListener('turbo:load', setLocale);
</script>